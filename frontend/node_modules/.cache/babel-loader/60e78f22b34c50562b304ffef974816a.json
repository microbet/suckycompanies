{"ast":null,"code":"import _classCallCheck from \"C:\\\\Users\\\\jayne\\\\dafuckisthis\\\\frontend\\\\node_modules\\\\@babel\\\\runtime/helpers/esm/classCallCheck\";\nimport _createClass from \"C:\\\\Users\\\\jayne\\\\dafuckisthis\\\\frontend\\\\node_modules\\\\@babel\\\\runtime/helpers/esm/createClass\";\nimport _possibleConstructorReturn from \"C:\\\\Users\\\\jayne\\\\dafuckisthis\\\\frontend\\\\node_modules\\\\@babel\\\\runtime/helpers/esm/possibleConstructorReturn\";\nimport _getPrototypeOf from \"C:\\\\Users\\\\jayne\\\\dafuckisthis\\\\frontend\\\\node_modules\\\\@babel\\\\runtime/helpers/esm/getPrototypeOf\";\nimport _inherits from \"C:\\\\Users\\\\jayne\\\\dafuckisthis\\\\frontend\\\\node_modules\\\\@babel\\\\runtime/helpers/esm/inherits\";\nvar _jsxFileName = \"C:\\\\Users\\\\jayne\\\\dafuckisthis\\\\frontend\\\\src\\\\components\\\\Answers.js\";\nimport React, { Component } from 'react';\nimport './MainPic.css'; // import User from '../User';\n\nvar Answers =\n/*#__PURE__*/\nfunction (_Component) {\n  _inherits(Answers, _Component);\n\n  function Answers(props) {\n    var _this;\n\n    _classCallCheck(this, Answers);\n\n    _this = _possibleConstructorReturn(this, _getPrototypeOf(Answers).call(this, props)); //  var user = new User();\n\n    _this.handleUlClick = function (event) {\n      if (_this.props.user.userId) {\n        var fd = new FormData();\n        fd.append('answer_id', event.target.getAttribute('thisanswerid'));\n        fd.append('vote', event.target.getAttribute('vote'));\n        fd.append('user_id', _this.props.user.userId);\n        fd.append('sessionvalue', _this.props.user.sessionvalue);\n        fetch(_this.props.DATA_URI + '/vote', {\n          method: 'POST',\n          headers: {\n            'Accept': 'application/json'\n          },\n          credentials: 'same-origin',\n          body: fd\n        }).then(function (response) {\n          return response.json();\n        }).then(function (data) {\n          _this.buildBatch(data['answer_id'], data['up'], data['down']);\n        }).catch(function (error) {\n          console.log(\"error: \", error);\n        });\n      }\n    };\n\n    _this.buildBatch = function (answerId, up, down) {\n      var i = 0;\n      var tempArr = _this.state.answerBatch;\n\n      _this.state.answerBatch.forEach(function (element) {\n        if (element[1] === parseInt(answerId)) {\n          tempArr[i][2] = up;\n          tempArr[i][3] = down;\n        }\n\n        i++;\n      });\n\n      _this.setState({\n        answerBatch: tempArr\n      });\n    };\n\n    _this.handleScroll = function (event) {\n      if (document.getElementById('answerBox').scrollHeight - document.getElementById('answerBox').offsetHeight === document.getElementById('answerBox').scrollTop) {\n        _this.fetchAnswer(_this.state.oldestAnswerId, _this.props.imageId, 'next');\n      } else if (document.getElementById('answerBox').scrollTop === 0) {\n        _this.fetchAnswer(_this.state.newestAnswerId, _this.props.imageId, 'previous');\n      } else {\n        clearInterval(_this.timer);\n\n        _this.setState({\n          scrollTimer: true\n        });\n      }\n    };\n\n    _this.state = {\n      answerBatch: [],\n      // [ [answer, answerId, up, down], ... ]\n      oldestAnswerId: 0,\n      newestAnswerId: 0,\n      mostVotedAnswerBatch: 0,\n      most: 'netUp',\n      scrollTimer: true //  userId : this.props.user.userId,\n\n    };\n    return _this;\n  }\n\n  _createClass(Answers, [{\n    key: \"componentDidMount\",\n    value: function componentDidMount() {\n      //    document.getElementById('answerBox').addEventListener('scroll', this.handleScroll);\n      if (this.props.user.imageId) {\n        // did this happen and with what image id when you first hit most answered\n        console.log(\"what imageid = \", this.props.user.imageId);\n        this.fetchData();\n        this.fetchMost(this.state.most);\n      }\n    }\n  }, {\n    key: \"componentWillUnmount\",\n    value: function componentWillUnmount() {\n      clearInterval(this.timer); //   ReactDOM.findDOMNode(this).addEventListener('scroll', this.handleScroll);\n    }\n  }, {\n    key: \"componentWillReceiveProps\",\n    value: function componentWillReceiveProps(answerToggle) {\n      if (this.props.imageId) {\n        this.fetchData();\n        this.fetchMost(this.state.most); // this should probably be set in state\n      }\n    }\n  }, {\n    key: \"fetchMost\",\n    value: function fetchMost(type) {\n      var _this2 = this;\n\n      var endpoint;\n\n      if (type === 'netUp') {\n        endpoint = '/get_most_net_upvoted';\n      }\n\n      if (type === 'netDown') {\n        endpoint = '/get_most_net_downvoted';\n      }\n\n      if (type === 'mostUp') {\n        endpoint = '/get_most_upvoted';\n      }\n\n      if (type === 'mostDown') {\n        endpoint = '/get_most_downvoted';\n      }\n\n      if (type === 'most') {\n        endpoint = '/get_most_voted';\n      }\n\n      var retArr = [];\n      fetch(this.props.DATA_URI + endpoint + \"?imageId=\" + this.props.imageId, {\n        method: 'GET',\n        headers: {\n          'Accept': 'application/json'\n        },\n        credentials: 'same-origin'\n      }).then(function (response) {\n        return response.json();\n      }).then(function (data) {\n        data.forEach(function (element) {\n          retArr.push([element['answer'], element['answerId'], element['up'], element['down']]);\n        });\n\n        _this2.setState({\n          mostVotedAnswerBatch: retArr\n        });\n      }).catch(function (error) {\n        console.log(\"error: \", error);\n      });\n    }\n  }, {\n    key: \"fetchData\",\n    value: function fetchData() {\n      var _this3 = this;\n\n      console.log(\"heyo\");\n      var retArr = [];\n      fetch(this.props.DATA_URI + \"/get_answers?imageId=\" + this.props.imageId + \"&answerId=\" + 0, {\n        method: 'GET',\n        headers: {\n          'Accept': 'application/json'\n        },\n        credentials: \"same-origin\"\n      }).then(function (response) {\n        return response.json();\n      }).then(function (data) {\n        var thisOldAnswerId = 0;\n        var thisNewAnswerId = 0;\n        data.forEach(function (element) {\n          retArr.push([element['answer'], element['answerId'], element['up'], element['down']]);\n\n          if (thisOldAnswerId === 0) {\n            thisOldAnswerId = element['answerId'];\n            thisNewAnswerId = element['answerId'];\n          } else {\n            if (element['answerId'] < thisOldAnswerId) {\n              thisOldAnswerId = element['answerId'];\n            }\n\n            if (element['answerId'] > thisNewAnswerId) {\n              thisNewAnswerId = element['answerId'];\n            }\n          }\n        });\n        retArr = retArr.sort(function (a, b) {\n          return b[1] - a[1];\n        });\n\n        _this3.setState({\n          answerBatch: retArr\n        });\n\n        _this3.setState({\n          oldestAnswerId: thisOldAnswerId\n        });\n\n        _this3.setState({\n          newestAnswerId: thisNewAnswerId\n        });\n      }).catch(function (error) {\n        console.log(\"error: \", error);\n      });\n    } // just for diagnostics \n\n  }, {\n    key: \"sleep\",\n    value: function sleep(milliseconds) {\n      var start = new Date().getTime();\n\n      for (var i = 0; i < 1e7; i++) {\n        document.getElementById('answerBox').scrollTop = 506;\n\n        if (new Date().getTime() - start > milliseconds) {\n          break;\n        }\n      }\n    } // dunno if this should be a separate function from fetchData or not, maybe combine later\n\n  }, {\n    key: \"fetchAnswer\",\n    value: function fetchAnswer(answerId, imageId, direction) {\n      var _this4 = this;\n\n      // (direction is 'next' or 'previous'\n      fetch(this.props.DATA_URI + \"/get_answer?imageId=\" + imageId + \"&answerId=\" + answerId + \"&direction=\" + direction, {\n        method: 'GET',\n        headers: {\n          'Accept': 'application/json'\n        },\n        credentials: \"same-origin\"\n      }).then(function (response) {\n        return response.json();\n      }).then(function (data) {\n        if (data.response === 'done') {\n          // do something to the next or previous button here\n          if (direction === 'next') {\n            document.getElementById('nextMainImage').setAttribute(\"style\", \"background-color: #636363;\");\n            document.getElementById('nextMainImage').setAttribute(\"disabled\", \"true;\");\n          }\n\n          if (direction === 'previous') {\n            document.getElementById('previousMainImage').setAttribute(\"style\", \"background-color: #636363;\");\n            document.getElementById('previousMainImage').setAttribute(\"disabled\", \"true;\");\n          }\n\n          return null;\n        } else {\n          document.getElementById('previousMainImage').setAttribute(\"style\", \"background-color: null;\");\n          document.getElementById('nextMainImage').setAttribute(\"style\", \"background-color: null;\");\n          document.getElementById('previousMainImage').removeAttribute(\"disabled\", \"true;\");\n          document.getElementById('nextMainImage').removeAttribute(\"disabled\", \"true;\");\n        }\n\n        var tempArr = _this4.state.answerBatch;\n\n        if (direction === 'next') {\n          tempArr.push([data[0]['answer'], data[0]['answerId'], data[0]['up'], data[0]['down']]);\n          tempArr.shift(); //  setTimeout(function() {\n          //    document.getElementById('answerBox').scrollTop = 506;\n          //  }, 500);\n        }\n\n        if (direction === 'previous') {\n          tempArr.splice(0, 0, [data[0]['answer'], data[0]['answerId'], data[0]['up'], data[0]['down']]);\n          tempArr.pop();\n        }\n\n        _this4.setState({\n          answerBatch: tempArr\n        });\n\n        if (direction === 'next') {\n          _this4.setState({\n            oldestAnswerId: data[0]['answerId']\n          });\n\n          _this4.setState({\n            newestAnswerId: tempArr[0][1]\n          });\n        }\n\n        if (direction === 'previous') {\n          _this4.setState({\n            newestAnswerId: data[0]['answerId']\n          });\n\n          _this4.setState({\n            oldestAnswerId: tempArr[9][1]\n          });\n        } //    if (this.state.scrollTimer) {\n        //      this.timer = setInterval(() => {\n        //        this.handleScroll();\n        //      }, 1000);\n        //      this.setState( { scrollTimer : false } );\n        //    }\n\n      }).catch(function (error) {\n        console.log(\"error: \", error);\n      });\n    }\n    /*\r\n    fetchPreviousAnswer(answerId, imageId) {\r\n      fetch( this.props.DATA_URI + \"/get_previous_answer?imageId=\" + imageId + \"&answerId=\" + answerId, { \r\n        credentials : \"same-origin\",\r\n        method: 'GET',\r\n        headers: {\r\n          'Accept': 'application/json',\r\n        }, \r\n      } )\r\n        .then(response => response.json())\r\n        .then(data => {\r\n          if (data.response !== 'newest') {\r\n            let tempArr = this.state.answerBatch;\r\n            tempArr.splice(0,0,[data[0]['answer'], data[0]['answerId'], \r\n              data[0]['up'], data[0]['down']]);\r\n            tempArr.pop();\r\n            this.setState( { answerBatch : tempArr } );\r\n            this.setState( { newestAnswerId : data[0]['answerId'] } );\r\n            this.setState( { oldestAnswerId : tempArr[9][1] } );\r\n              if (this.state.scrollTimer) {\r\n              this.timer = setInterval(() => {\r\n                this.handleScroll();\r\n              }, 1000);\r\n              this.setState( { scrollTimer : false } );\r\n            }\r\n          }\r\n        })\r\n        .catch(error => {\r\n          console.log(\"error: \", error);\r\n        })\r\n    }\r\n    */\n\n  }, {\n    key: \"render\",\n    value: function render() {\n      var _this5 = this;\n\n      var display = [];\n\n      if (Array.isArray(this.state.answerBatch)) {\n        if (this.state.answerBatch.length > 0) {\n          this.state.answerBatch.forEach(function (element) {\n            display.push(React.createElement(\"ul\", {\n              key: element[1],\n              className: \"Answer-list\",\n              __source: {\n                fileName: _jsxFileName,\n                lineNumber: 289\n              },\n              __self: this\n            }, element[0], React.createElement(\"div\", {\n              onClick: _this5.handleUlClick,\n              thisanswerid: element[1],\n              vote: \"up\",\n              key: element[1] + 'upvote',\n              __source: {\n                fileName: _jsxFileName,\n                lineNumber: 290\n              },\n              __self: this\n            }, _this5.props.user.userId ? \"thumbup \" : null), React.createElement(\"div\", {\n              __source: {\n                fileName: _jsxFileName,\n                lineNumber: 292\n              },\n              __self: this\n            }, \" \", element[2], \" up\"), React.createElement(\"div\", {\n              onClick: _this5.handleUlClick,\n              thisanswerid: element[1],\n              vote: \"down\",\n              key: element[1] + 'downvote',\n              __source: {\n                fileName: _jsxFileName,\n                lineNumber: 293\n              },\n              __self: this\n            }, _this5.props.user.userId ? \"thumbdown \" : null), React.createElement(\"div\", {\n              __source: {\n                fileName: _jsxFileName,\n                lineNumber: 295\n              },\n              __self: this\n            }, \" \", element[3], \" down\")));\n          });\n        }\n      }\n\n      var mostVotedDisplay = [];\n\n      if (Array.isArray(this.state.mostVotedAnswerBatch)) {\n        if (this.state.mostVotedAnswerBatch.length > 0) {\n          this.state.mostVotedAnswerBatch.forEach(function (element) {\n            mostVotedDisplay.push(React.createElement(\"ul\", {\n              key: element[1] + 'mostvoted',\n              __source: {\n                fileName: _jsxFileName,\n                lineNumber: 305\n              },\n              __self: this\n            }, element[0], React.createElement(\"div\", {\n              thisanswerid: element[1],\n              vote: \"up\",\n              key: element[1] + 'mostVote',\n              __source: {\n                fileName: _jsxFileName,\n                lineNumber: 306\n              },\n              __self: this\n            }, _this5.props.user.userId ? \"thumbup \" : null), React.createElement(\"div\", {\n              __source: {\n                fileName: _jsxFileName,\n                lineNumber: 308\n              },\n              __self: this\n            }, \" \", element[2], \" up\"), React.createElement(\"div\", {\n              thisanswerid: element[1],\n              vote: \"down\",\n              key: element[1] + 'downvote',\n              __source: {\n                fileName: _jsxFileName,\n                lineNumber: 309\n              },\n              __self: this\n            }, _this5.props.user.userId ? \"thumbdown \" : null), React.createElement(\"div\", {\n              __source: {\n                fileName: _jsxFileName,\n                lineNumber: 311\n              },\n              __self: this\n            }, \" \", element[3], \" down\")));\n          });\n        }\n      }\n\n      return React.createElement(\"div\", {\n        className: \"Answer-box\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 318\n        },\n        __self: this\n      }, React.createElement(\"center\", {\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 318\n        },\n        __self: this\n      }, React.createElement(\"button\", {\n        onClick: function onClick() {\n          _this5.fetchAnswer(_this5.state.oldestAnswerId, _this5.props.imageId, 'next');\n        },\n        id: \"nextMainImage\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 319\n        },\n        __self: this\n      }, \"Next\"), React.createElement(\"button\", {\n        onClick: function onClick() {\n          _this5.fetchAnswer(_this5.state.newestAnswerId, _this5.props.imageId, 'previous');\n        },\n        id: \"previousMainImage\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 320\n        },\n        __self: this\n      }, \"Previous\")), React.createElement(\"div\", {\n        className: \"Answer-box1\",\n        id: \"answerBox\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 322\n        },\n        __self: this\n      }, display), React.createElement(\"br\", {\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 325\n        },\n        __self: this\n      }), React.createElement(\"br\", {\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 326\n        },\n        __self: this\n      }), React.createElement(\"div\", {\n        className: \"answerBox\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 327\n        },\n        __self: this\n      }, React.createElement(\"button\", {\n        onClick: function onClick() {\n          _this5.fetchMost('netUp');\n        },\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 328\n        },\n        __self: this\n      }, \"Net Up\"), React.createElement(\"button\", {\n        onClick: function onClick() {\n          _this5.fetchMost('netDown');\n        },\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 329\n        },\n        __self: this\n      }, \"Net Down\"), React.createElement(\"button\", {\n        onClick: function onClick() {\n          _this5.fetchMost('mostUp');\n        },\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 330\n        },\n        __self: this\n      }, \"Most Up\"), React.createElement(\"button\", {\n        onClick: function onClick() {\n          _this5.fetchMost('mostDown');\n        },\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 331\n        },\n        __self: this\n      }, \"Most Down\"), React.createElement(\"button\", {\n        onClick: function onClick() {\n          _this5.fetchMost('most');\n        },\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 332\n        },\n        __self: this\n      }, \"Most\"), mostVotedDisplay));\n    }\n  }]);\n\n  return Answers;\n}(Component);\n\nexport default Answers;","map":{"version":3,"sources":["C:\\Users\\jayne\\dafuckisthis\\frontend\\src\\components\\Answers.js"],"names":["React","Component","Answers","props","handleUlClick","event","user","userId","fd","FormData","append","target","getAttribute","sessionvalue","fetch","DATA_URI","method","headers","credentials","body","then","response","json","data","buildBatch","catch","error","console","log","answerId","up","down","i","tempArr","state","answerBatch","forEach","element","parseInt","setState","handleScroll","document","getElementById","scrollHeight","offsetHeight","scrollTop","fetchAnswer","oldestAnswerId","imageId","newestAnswerId","clearInterval","timer","scrollTimer","mostVotedAnswerBatch","most","fetchData","fetchMost","answerToggle","type","endpoint","retArr","push","thisOldAnswerId","thisNewAnswerId","sort","a","b","milliseconds","start","Date","getTime","direction","setAttribute","removeAttribute","shift","splice","pop","display","Array","isArray","length","mostVotedDisplay"],"mappings":"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","sourcesContent":["import React, { Component } from 'react';\r\nimport './MainPic.css';\r\n// import User from '../User';\r\n\r\nclass Answers extends Component {\r\n  constructor(props){\r\n    super(props);\r\n  //  var user = new User();\r\n    this.state = {\r\n      answerBatch : [], // [ [answer, answerId, up, down], ... ]\r\n      oldestAnswerId : 0,\r\n      newestAnswerId : 0,\r\n\t\t  mostVotedAnswerBatch : 0,\r\n      most : 'netUp',\r\n      scrollTimer : true,\r\n    //  userId : this.props.user.userId,\r\n    }\r\n  }\r\n\r\n  componentDidMount() {\r\n//    document.getElementById('answerBox').addEventListener('scroll', this.handleScroll);\r\n    if (this.props.user.imageId) {\r\n      // did this happen and with what image id when you first hit most answered\r\n      console.log(\"what imageid = \", this.props.user.imageId);\r\n      this.fetchData();\r\n      this.fetchMost(this.state.most);\r\n    }\r\n  }\r\n\r\n  componentWillUnmount() {\r\n    clearInterval(this.timer);\r\n //   ReactDOM.findDOMNode(this).addEventListener('scroll', this.handleScroll);\r\n  }\r\n  \r\n  componentWillReceiveProps(answerToggle) {\r\n    if (this.props.imageId) {\r\n\t  this.fetchData();\r\n\t  this.fetchMost(this.state.most); // this should probably be set in state\r\n    }\r\n  }\r\n\r\n  fetchMost(type) {\r\n    let endpoint;\r\n    if (type === 'netUp') { endpoint = '/get_most_net_upvoted'; }\r\n    if (type === 'netDown') { endpoint = '/get_most_net_downvoted'; }\r\n    if (type === 'mostUp') { endpoint = '/get_most_upvoted'; }\r\n    if (type === 'mostDown') { endpoint = '/get_most_downvoted'; }\r\n    if (type === 'most') { endpoint = '/get_most_voted'; }\r\n\t  let retArr = [];\r\n\t  fetch( this.props.DATA_URI + endpoint + \"?imageId=\" + this.props.imageId, {\r\n\t\t  method: 'GET',\r\n\t\t  headers: { 'Accept': 'application/json' },\r\n\t\t  credentials: 'same-origin',\r\n\t  })\r\n\t  .then(response => response.json())\r\n\t  .then(data => {\r\n\t\t  data.forEach(function(element) {\r\n\t\t\t  retArr.push([element['answer'], element['answerId'], \r\n              element['up'], element['down']]);\r\n      });\r\n      this.setState( { mostVotedAnswerBatch : retArr } )\r\n      })\r\n      .catch(error => {\r\n        console.log(\"error: \", error);\r\n      })\r\n  }\r\n  \r\n  fetchData() {\r\n    console.log(\"heyo\");\r\n    let retArr = [];\r\n    fetch( this.props.DATA_URI + \"/get_answers?imageId=\" + this.props.imageId + \"&answerId=\" + 0, { \r\n      method: 'GET',\r\n      headers: {\r\n        'Accept': 'application/json',\r\n      }, \r\n      credentials : \"same-origin\" \r\n      } )\r\n      .then(response => response.json())\r\n      .then(data =>  {\r\n         let thisOldAnswerId = 0;\r\n         let thisNewAnswerId = 0;\r\n         data.forEach(function(element) {\r\n           retArr.push([element['answer'], element['answerId'], \r\n              element['up'], element['down']]);\r\n\t     if (thisOldAnswerId === 0) {\r\n         thisOldAnswerId = element['answerId'];\r\n         thisNewAnswerId = element['answerId'];\r\n       } else {\r\n         if (element['answerId'] < thisOldAnswerId) {\r\n           thisOldAnswerId = element['answerId'];\r\n         }\r\n         if (element['answerId'] > thisNewAnswerId) {\r\n           thisNewAnswerId = element['answerId'];\r\n         }\r\n       }\r\n     });\r\n\t retArr = retArr.sort(function(a, b) {\r\n\t   return b[1] - a[1];\r\n\t });\r\n   this.setState( { answerBatch : retArr } )\r\n   this.setState({ oldestAnswerId : thisOldAnswerId })\r\n   this.setState({ newestAnswerId : thisNewAnswerId })\r\n   })\r\n   .catch(error => {\r\n     console.log(\"error: \", error);\r\n   })\r\n  }\r\n  \r\n// just for diagnostics \r\n sleep(milliseconds) {\r\n  var start = new Date().getTime();\r\n  for (var i = 0; i < 1e7; i++) {\r\n    document.getElementById('answerBox').scrollTop = 506;\r\n    if ((new Date().getTime() - start) > milliseconds){\r\n      break;\r\n    }\r\n  }\r\n}\r\n\r\n\r\n  // dunno if this should be a separate function from fetchData or not, maybe combine later\r\n  fetchAnswer(answerId, imageId, direction) {   // (direction is 'next' or 'previous'\r\n    fetch( this.props.DATA_URI + \"/get_answer?imageId=\" + imageId + \r\n      \"&answerId=\" + answerId + \"&direction=\" + direction, { \r\n      method: 'GET',\r\n      headers: {\r\n        'Accept': 'application/json',\r\n      }, \r\n      credentials : \"same-origin\" } )\r\n      .then(response => response.json())\r\n      .then(data =>  {\r\n        if (data.response === 'done') {\r\n          // do something to the next or previous button here\r\n          if (direction === 'next') {\r\n            document.getElementById('nextMainImage').setAttribute(\"style\", \"background-color: #636363;\");\r\n            document.getElementById('nextMainImage').setAttribute(\"disabled\", \"true;\");\r\n          }\r\n          if (direction === 'previous') {\r\n            document.getElementById('previousMainImage').setAttribute(\"style\", \"background-color: #636363;\");\r\n            document.getElementById('previousMainImage').setAttribute(\"disabled\", \"true;\");\r\n          }\r\n          return null;\r\n        } else {\r\n          document.getElementById('previousMainImage').setAttribute(\"style\", \"background-color: null;\");\r\n          document.getElementById('nextMainImage').setAttribute(\"style\", \"background-color: null;\");\r\n          document.getElementById('previousMainImage').removeAttribute(\"disabled\", \"true;\");\r\n          document.getElementById('nextMainImage').removeAttribute(\"disabled\", \"true;\");\r\n        }\r\n\r\n\t      let tempArr = this.state.answerBatch;\r\n        if (direction === 'next') {\r\n\t        tempArr.push([data[0]['answer'], data[0]['answerId'],\r\n            data[0]['up'], data[0]['down']]);\r\n\t        tempArr.shift();\r\n        //  setTimeout(function() {\r\n        //    document.getElementById('answerBox').scrollTop = 506;\r\n        //  }, 500);\r\n        }\r\n        if (direction === 'previous') {\r\n          tempArr.splice(0,0,[data[0]['answer'], data[0]['answerId'], \r\n            data[0]['up'], data[0]['down']]);\r\n          tempArr.pop();\r\n        }\r\n\t      this.setState( { answerBatch : tempArr } );\r\n        if (direction === 'next') {\r\n\t        this.setState( { oldestAnswerId : data[0]['answerId'] } );\r\n          this.setState( { newestAnswerId : tempArr[0][1] } );\r\n        }\r\n        if (direction === 'previous') {\r\n          this.setState( { newestAnswerId : data[0]['answerId'] } );\r\n          this.setState( { oldestAnswerId : tempArr[9][1] } );\r\n        }\r\n    //    if (this.state.scrollTimer) {\r\n    //      this.timer = setInterval(() => {\r\n    //        this.handleScroll();\r\n    //      }, 1000);\r\n    //      this.setState( { scrollTimer : false } );\r\n    //    }\r\n      })\r\n      .catch(error => {\r\n        console.log(\"error: \", error);\r\n      })\r\n  }\r\n\r\n  /*\r\n  fetchPreviousAnswer(answerId, imageId) {\r\n    fetch( this.props.DATA_URI + \"/get_previous_answer?imageId=\" + imageId + \"&answerId=\" + answerId, { \r\n      credentials : \"same-origin\",\r\n      method: 'GET',\r\n      headers: {\r\n        'Accept': 'application/json',\r\n      }, \r\n    } )\r\n      .then(response => response.json())\r\n      .then(data => {\r\n        if (data.response !== 'newest') {\r\n          let tempArr = this.state.answerBatch;\r\n          tempArr.splice(0,0,[data[0]['answer'], data[0]['answerId'], \r\n            data[0]['up'], data[0]['down']]);\r\n          tempArr.pop();\r\n          this.setState( { answerBatch : tempArr } );\r\n          this.setState( { newestAnswerId : data[0]['answerId'] } );\r\n          this.setState( { oldestAnswerId : tempArr[9][1] } );\r\n\r\n          if (this.state.scrollTimer) {\r\n            this.timer = setInterval(() => {\r\n              this.handleScroll();\r\n            }, 1000);\r\n            this.setState( { scrollTimer : false } );\r\n          }\r\n        }\r\n      })\r\n      .catch(error => {\r\n        console.log(\"error: \", error);\r\n      })\r\n  }\r\n  */\r\n\r\n  handleUlClick = (event) => {\r\n    if (this.props.user.userId) {\r\n      const fd = new FormData();\r\n      fd.append('answer_id', event.target.getAttribute('thisanswerid'));\r\n      fd.append('vote', event.target.getAttribute('vote'));\r\n      fd.append('user_id', this.props.user.userId);\r\n      fd.append('sessionvalue', this.props.user.sessionvalue);\r\n      fetch( this.props.DATA_URI + '/vote', {\r\n        method: 'POST',\r\n        headers: {\r\n        'Accept': 'application/json',\r\n        },\r\n        credentials : 'same-origin',\r\n        body: fd\r\n      })\r\n      .then(response => response.json())\r\n\t  .then(data => {\r\n\t\t  this.buildBatch(data['answer_id'], data['up'], data['down'])\r\n\t  })\r\n      .catch(error => {\r\n        console.log(\"error: \", error);\r\n      });\r\n    }\r\n  }\r\n  \r\n  buildBatch = (answerId, up, down) => {\r\n    let i = 0;\r\n    let tempArr = this.state.answerBatch;\r\n    this.state.answerBatch.forEach( function(element) {\r\n\t  if (element[1] === parseInt(answerId)) {\r\n\t\ttempArr[i][2] = up;\r\n        tempArr[i][3] = down;\r\n      }\r\n\t  i++;\r\n    });\r\n    this.setState({ answerBatch : tempArr });\r\n  }\r\n\r\n  /*\r\n  handleScroll = (event) => {\r\n    console.log(\"hwkhj\");\r\n     if (ReactDOM.findDOMNode(this).scrollHeight - ReactDOM.findDOMNode(this).offsetHeight - 1 < ReactDOM.findDOMNode(this).scrollTop) {\r\n       this.fetchNextAnswer(this.state.oldestAnswerId, this.props.imageId);\r\n     } else if (ReactDOM.findDOMNode(this).scrollTop === 0) {\r\n       this.fetchPreviousAnswer(this.state.newestAnswerId, this.props.imageId);\r\n     } else {\r\n       clearInterval(this.timer);\r\n       this.setState( { scrollTimer : true } );\r\n     }\r\n  }\r\n  */\r\n  //  document.getElementById('answerBox').addEventListener('scroll', this.handleScroll);\r\n\r\n  handleScroll = (event) => {\r\n     if (document.getElementById('answerBox').scrollHeight - document.getElementById('answerBox').offsetHeight === document.getElementById('answerBox').scrollTop) {\r\n       this.fetchAnswer(this.state.oldestAnswerId, this.props.imageId, 'next');\r\n     } else if (document.getElementById('answerBox').scrollTop === 0) {\r\n       this.fetchAnswer(this.state.newestAnswerId, this.props.imageId, 'previous');\r\n     } else {\r\n       clearInterval(this.timer);\r\n       this.setState( { scrollTimer : true } );\r\n     }\r\n  }\r\n\r\n  render() {\r\n    let display = [];\r\n    if (Array.isArray(this.state.answerBatch)) {\r\n      if (this.state.answerBatch.length > 0) {\r\n        this.state.answerBatch.forEach((element) => {\r\n           display.push(\r\n             <ul key={element[1]} className=\"Answer-list\">{element[0]}\r\n             <div onClick={this.handleUlClick} thisanswerid={element[1]} vote=\"up\"\r\n\t\t\t\tkey={element[1] + 'upvote'}>{ this.props.user.userId ? \"thumbup \" : null }</div>\r\n\t\t\t\t<div> { element[2] } up</div>\r\n\t\t\t<div onClick={this.handleUlClick} thisanswerid={element[1]} vote='down'\r\n\t\t\t\tkey={element[1] + 'downvote'}>{ this.props.user.userId ? \"thumbdown \" : null }</div>\r\n\t\t\t\t<div> { element[3] } down</div>\t\r\n             </ul>);\r\n        });\r\n      }\r\n    }\r\n\tlet mostVotedDisplay = []\r\n\tif (Array.isArray(this.state.mostVotedAnswerBatch)) {\r\n\t\tif (this.state.mostVotedAnswerBatch.length > 0) {\r\n\t\t\tthis.state.mostVotedAnswerBatch.forEach((element) => {\r\n\t\t\t\tmostVotedDisplay.push(\r\n\t\t\t\t\t<ul key={element[1] + 'mostvoted'}>{element[0]}\r\n\t\t\t<div thisanswerid={element[1]} vote='up'\r\n\t\t\t\tkey={element[1] + 'mostVote'}>{ this.props.user.userId ? \"thumbup \" : null }</div>\r\n\t\t\t\t<div> { element[2] } up</div>\r\n\t\t\t<div thisanswerid={element[1]} vote='down'\r\n\t\t\t\tkey={element[1] + 'downvote'}>{ this.props.user.userId ? \"thumbdown \" : null }</div>\r\n\t\t\t\t<div> { element[3] } down</div>\r\n\t\t\t\t</ul>);\r\n\t\t});\r\n\t  }\r\n\t}\r\n\t\r\n    return(\r\n\t<div className=\"Answer-box\"><center>\r\n      <button onClick={() => {this.fetchAnswer(this.state.oldestAnswerId, this.props.imageId, 'next')}} id=\"nextMainImage\">Next</button>\r\n      <button onClick={() => {this.fetchAnswer(this.state.newestAnswerId, this.props.imageId, 'previous')}} id=\"previousMainImage\">Previous</button>\r\n      </center>\r\n          <div className=\"Answer-box1\" id=\"answerBox\">\r\n          { display }\r\n\t\t  </div>\r\n\t\t\t<br />\r\n\t\t\t<br />\r\n\t\t\t<div className=\"answerBox\">\r\n     <button onClick={() => {this.fetchMost('netUp')}}>Net Up</button>\r\n     <button onClick={() => {this.fetchMost('netDown')}}>Net Down</button>\r\n     <button onClick={() => {this.fetchMost('mostUp')}}>Most Up</button>\r\n     <button onClick={() => {this.fetchMost('mostDown')}}>Most Down</button>\r\n     <button onClick={() => {this.fetchMost('most')}}>Most</button>\r\n\t\t\t{ mostVotedDisplay }\r\n          </div>\r\n\t\t  </div>\r\n\t);\r\n    }\r\n}\r\n\r\nexport default Answers \r\n"]},"metadata":{},"sourceType":"module"}